---
import { getCollection } from 'astro:content';
import Base from "@/layouts/Base.astro";

const allPosts = await getCollection('posts', ({ data }) => !data.draft);

const latestPosts = allPosts
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<Base title="Txchyon Capital">
  <div class="container mx-auto py-12 px-4 max-w-4xl">
    <div class="text-center mb-16">
      <h1 class="text-5xl font-bold mb-6">Txchyon Capital</h1>
      <p class="text-xl text-gray-300 leading-relaxed">
        Advanced crypto research, airdrop farming guides, and trading strategies.
      </p>
    </div>

    <div class="space-y-20">
      {latestPosts.length === 0 ? (
        <p class="text-center text-gray-500 py-12">No posts published yet.</p>
      ) : (
        latestPosts.map((post) => {
          const { title, description, date } = post.data;
          const { slug } = post;

          const formattedDate = new Date(date).toLocaleDateString('en-US', {
            day: 'numeric',
            month: 'long',
            year: 'numeric'
          });

          return (
            <article class="border-b border-gray-200 dark:border-gray-800 pb-20 last:border-0 last:pb-0">
              <p class="text-gray-500 dark:text-gray-400 text-sm mb-4">
                * NefuTrades * {formattedDate}
              </p>
              <h2 class="text-4xl font-bold mb-6">
                <!-- FIXED: Changed /posts/ to /blog/ -->
                <a href={`/blog/${slug}`} class="hover:text-primary transition-colors">
                  {title}
                </a>
              </h2>
              {description && (
                <p class="text-lg text-gray-600 dark:text-gray-400 leading-relaxed mb-8">
                  {description}
                </p>
              )}
              <!-- FIXED: Changed /posts/ to /blog/ -->
              <a href={`/blog/${slug}`} class="text-primary font-medium hover:underline">
                Read the full guide â†’
              </a>
            </article>
          );
        })
      )}
    </div>
  </div>
</Base>